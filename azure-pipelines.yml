trigger:
- main

pool:
  vmImage: 'ubuntu-latest'

steps:
- task: NodeTool@0
  inputs:
    versionSpec: '20.x'
  displayName: 'Install Node.js'

- script: npm install -g @angular/cli
  displayName: 'Install Angular CLI'

- script: npm install
  displayName: 'Install dependencies'

- script: npm run build -- --configuration=production
  displayName: 'Build Angular app'

- script: npm test -- --watch=false --browsers=ChromeHeadless
  displayName: 'Run unit tests'

- task: PublishBuildArtifacts@1
  inputs:
    PathtoPublish: 'dist'
    ArtifactName: 'angular-app'
    publishLocation: 'Container'
  displayName: 'Publish build artifacts'
